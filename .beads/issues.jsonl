{"id":"meal-planner-1ost","title":"Create custom_foods table migration and storage functions","description":"Unified food search requires custom_foods table to store user-created foods alongside USDA database.\n\n**Schema Needed:**\n- id (TEXT PRIMARY KEY)\n- user_id (TEXT)\n- name (TEXT)\n- brand (TEXT, nullable)\n- serving_size (REAL)\n- serving_unit (TEXT)\n- macros: protein, fat, carbs, calories\n- micronutrients: 21 columns (same as food_logs)\n- created_at, updated_at (TIMESTAMP)\n\n**Storage Functions:**\n- save_custom_food()\n- get_custom_food(id)\n- search_custom_foods(query, user_id)\n- delete_custom_food(id)","acceptance_criteria":"- [ ] Migration 008_custom_foods.sql created\n- [ ] Table includes all 21 micronutrient columns\n- [ ] Storage functions in storage.gleam\n- [ ] JSON encoders/decoders in types.gleam\n- [ ] API endpoint POST /api/custom-foods","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-03T14:47:16.259516813Z","updated_at":"2025-12-13T13:33:58.082705196Z","closed_at":"2025-12-13T13:33:58.082705196Z"}
{"id":"meal-planner-2r8f","title":"Write macro summary panel tests (TDD)","description":"Create macro_summary_test.gleam with tests: renders 7 daily totals, shows weekly averages (protein/fat/carbs), traffic light colors (green/yellow/red based on target %), visual progress bars render. Property test: averages \u003c= max(daily values). FRACTAL LOOP: Pass 1 (unit) - this task. Pass 2 (integration) - via page. Pass 3 (E2E) - Task 14. Pass 4 (review) - automated. Verify: gleam test macro_summary_test passes. Files: gleam/test/meal_planner/ui/components/macro_summary_test.gleam","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-04T03:14:33.28541577Z","updated_at":"2025-12-04T11:41:36.158080597Z"}
{"id":"meal-planner-2ux0","title":"Implement SMTP email sending in smtp_client.gleam","description":"File: gleam/src/meal_planner/integrations/smtp_client.gleam\n\nCURRENT: Returns Ok() stub, no actual SMTP integration\nTODO: Implement actual SMTP using gen_smtp via FFI or HTTP mail API\n\nREQUIREMENTS:\n- Connect to SMTP server (Gmail/SendGrid)\n- Send HTML emails\n- Handle authentication\n- Error handling\n\nVERIFY: Send test email succeeds\nBLOCKS: meal-planner-atfe (Wire scheduler to email sending)\nSOURCE: Code TODO comment","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-05T03:53:04.730940124Z","updated_at":"2025-12-05T03:53:04.730940124Z","dependencies":[{"issue_id":"meal-planner-2ux0","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.52173869Z","created_by":"daemon"}]}
{"id":"meal-planner-2ws","title":"E2E tests for logging flow","description":"End-to-end tests for complete food logging workflow: search → select → log → view","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T02:55:01.071271424Z","updated_at":"2025-12-13T13:36:13.853615674Z","closed_at":"2025-12-13T13:36:13.853615674Z"}
{"id":"meal-planner-36f","title":"Implement dashboard UI components","description":"Complete dashboard.gleam implementation: render_dashboard layout, calorie_summary card, macro_progress_section with bars, daily_log_section with meal entries, date_selector navigation, meal_list_item component. Currently all return placeholder HTML comments.","status":"in_progress","priority":1,"issue_type":"task","assignee":"LilacStone","created_at":"2025-12-03T12:44:45.390790824Z","updated_at":"2025-12-03T22:46:55.430271518Z"}
{"id":"meal-planner-3yah","title":"[EPIC] Documentation-Driven Improvements","description":"Tasks derived from comprehensive documentation review (46 files)\n\nCATEGORIES:\n1. CI/CD Blockers (P4) - 2 tasks\n2. Migration \u0026 Performance (P3) - 1 task\n3. UI Enhancements (P1-P2) - 3 tasks\n4. Code Quality (P1-P2) - 4 tasks\n5. Security (P3) - 2 tasks\n6. Features (P2) - 3 tasks\n\nSUBTASKS (15 new beads created):\n- [deleted:meal-planner-d55v]: Fix swap.gleam type mismatch\n- [deleted:meal-planner-hih5]: Fix todoist_client_test assertions\n- meal-planner-jou4: Apply migration 010\n- [deleted:meal-planner-wj3w]: Add loading indicators\n- [deleted:meal-planner-ygb6]: Add live search HTMX\n- [deleted:meal-planner-lf3h]: Fix CSS ID inconsistency\n- meal-planner-2ux0: Implement SMTP\n- meal-planner-weir: Implement Todoist API\n- meal-planner-mb9v: NCP auto planner storage\n- [deleted:meal-planner-8jg5]: HTMX error boundaries\n- meal-planner-uaio: HTMX integration tests\n- [deleted:meal-planner-qtz8]: Authentication system\n- [deleted:meal-planner-n1ay]: Loading indicator component\n- [deleted:meal-planner-yxzp]: Extract filter constants\n- meal-planner-kznh: Rate limiting\n- meal-planner-9j9q: CSP headers\n- [deleted:meal-planner-3t0z]: Remove deprecated param\n\nSOURCE: 46 documentation files reviewed\nCOMPLETION: All doc items now tracked in beads","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-05T03:54:15.178074687Z","updated_at":"2025-12-12T22:07:57.973504166Z"}
{"id":"meal-planner-4cqt","title":"Complete JSON config parsing in storage.gleam","description":"Fix line 111 in auto_planner/storage.gleam. Current code uses json.parse(from:, using:) which may have API mismatch. Verify correct gleam/json API and ensure config_json is properly parsed and decoded to AutoPlanConfig type.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T02:49:39.868568738Z","updated_at":"2025-12-13T13:36:04.0374576Z","closed_at":"2025-12-13T13:36:04.0374576Z"}
{"id":"meal-planner-4gc9","title":"[Primitive Obsession] Step 4: Update remaining files to use MacroNutrients","description":"Update: UI components, tests, output formatters, validators. Run full test suite. Time: 2 hours. Files: 15+ files. Deliverable: Zero individual protein/fat/carbs parameters, all use MacroNutrients type.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T03:48:42.097692659Z","updated_at":"2025-12-04T03:48:42.097692659Z"}
{"id":"meal-planner-4iph","title":"Integrate cleanup script into CI/CD pipeline","description":"","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-04T03:49:41.406008109Z","updated_at":"2025-12-04T03:49:41.406008109Z"}
{"id":"meal-planner-4qic","title":"[Extract Method] Step 2: Create result_helpers.gleam with TDD","description":"TDD: Write test for result_to_storage_error(Result(a, pog.Error)) -\u003e Result(a, StorageError). Implement helper function. Verify: gleam test result_helpers_test passes. Time: 30min. Files: src/meal_planner/result_helpers.gleam, test/meal_planner/result_helpers_test.gleam (both new, \u003c50 LOC each).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:47:08.214754852Z","updated_at":"2025-12-13T13:34:46.672739395Z","closed_at":"2025-12-13T13:34:46.672739395Z","dependencies":[{"issue_id":"meal-planner-4qic","depends_on_id":"meal-planner-tkrt","type":"blocks","created_at":"2025-12-04T03:48:21.817835435Z","created_by":"daemon"}]}
{"id":"meal-planner-4xd","title":"Remove ARCHIVE folder","description":"Remove ARCHIVE/ directory (disabled tests, 152KB)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:26.814789902Z","updated_at":"2025-12-13T13:31:11.613739411Z","closed_at":"2025-12-13T13:31:11.613739411Z"}
{"id":"meal-planner-5kh3","title":"Implement unified food search (custom + USDA)","description":"Search should query both custom_foods and USDA foods tables, returning unified results.\n\n**Current:**\n- Only searches USDA foods table\n- FoodSearchResult union type exists (CustomFoodResult | UsdaFoodResult)\n- Types ready, implementation missing\n\n**Needed:**\n- unified_food_search(query, user_id) function\n- Query custom_foods first (user's foods prioritized)\n- Query USDA foods\n- Merge results with custom foods first\n- Return FoodSearchResponse with both sources\n\n**Depends on:** meal-planner-1ost (custom_foods table)","acceptance_criteria":"- [ ] Search queries both tables\n- [ ] Custom foods appear first in results\n- [ ] Result count shows: total, custom_count, usda_count\n- [ ] API endpoint GET /api/foods?q=query returns unified results\n- [ ] Performance: \u003c 300ms for combined query","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-03T14:47:17.157096274Z","updated_at":"2025-12-13T13:33:58.842776518Z","closed_at":"2025-12-13T13:33:58.842776518Z"}
{"id":"meal-planner-6f8v","title":"Re-enable and fix ncp_auto_planner_test.gleam","description":"Fix 36 operator precedence errors in ncp_auto_planner_test.gleam. Issue: \u003c. operator split across lines (e.g., deficit.protein_pct \u003c. -15.0 split into 2 lines). Need to join comparison operators with their operands on same line. File currently renamed to .disabled","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-04T22:29:34.841746929Z","updated_at":"2025-12-13T13:32:05.350534246Z","closed_at":"2025-12-13T13:32:05.350534246Z"}
{"id":"meal-planner-7y3u","title":"Add recently logged foods quick access","description":"Show user's 10 most recently logged foods at top of search page as quick-access chips. Query: SELECT DISTINCT ON (f.fdc_id) with JOIN on food_logs, ORDER BY last_logged DESC. UI: Recent chips above search box.","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2025-12-03T22:59:37.917084905Z","updated_at":"2025-12-05T05:40:29.375367986Z"}
{"id":"meal-planner-7zzg","title":"[Property Tests] Step 4: Write percentage calculation property test","description":"Property: protein% + fat% + carbs% = 100% (within 0.1 tolerance). Test with random macro distributions. Time: 30min. Files: test/meal_planner/properties/percentages_test.gleam (new, \u003c80 LOC).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:48:45.946990222Z","updated_at":"2025-12-13T13:36:50.186424129Z","closed_at":"2025-12-13T13:36:50.186424129Z","dependencies":[{"issue_id":"meal-planner-7zzg","depends_on_id":"meal-planner-n0s7","type":"blocks","created_at":"2025-12-04T03:49:06.37261307Z","created_by":"daemon"}]}
{"id":"meal-planner-8ll","title":"Accessibility improvements","description":"Add ARIA labels, keyboard navigation, focus management, and screen reader support","notes":"Accessibility improvements added to foods handler HTML - needs review","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T02:55:06.905315406Z","updated_at":"2025-12-13T13:36:59.664136629Z"}
{"id":"meal-planner-9e1w","title":"Technical Debt Analysis and Refactoring","description":"Comprehensive analysis of codebase technical debt with prioritized refactoring tasks","notes":"Technical Debt Analysis Complete:\n\nFINDINGS:\n1. Import cycle detected: result_helpers.gleam \u003c-\u003e storage/profile.gleam\n2. Multiple files auto-disabled due to compilation errors (foods handler, result_helpers, dashboard handler)\n3. Unused import warnings across storage/logs modules (cleaned up)\n4. Type re-export issues in storage/logs facade pattern\n5. Missing type annotations causing inference failures\n\nFIXES APPLIED:\n- Cleaned up unused imports in storage/logs.gleam and submodules\n- Fixed type re-exports for FoodSummaryItem and WeeklySummary\n- Removed 'macro' as parameter name (reserved keyword)\n- Fixed dashboard handler to use storage.get_user_profile\n\nREMAINING ISSUES:\n- Circular import between result_helpers and storage/profile needs refactoring\n- Handler files being auto-disabled indicate broader compilation issues\n- Need to run full test suite after resolving import cycles\n\nRECOMMENDATIONS:\n1. Move StorageError type to separate types module to break circular dependency\n2. Re-enable disabled handler files and fix compilation errors  \n3. Run full test suite to verify all modules compile\n4. Consider consolidating error handling patterns to avoid helper module dependencies","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-03T22:51:09.085910572Z","updated_at":"2025-12-13T13:36:23.378074911Z","closed_at":"2025-12-13T13:36:23.378074911Z"}
{"id":"meal-planner-9j9q","title":"Implement Content Security Policy (CSP) headers","description":"Add CSP headers to prevent XSS attacks\n\nHEADERS TO ADD:\nContent-Security-Policy:\n- default-src 'self'\n- script-src 'self' https://unpkg.com/htmx.org\n- style-src 'self' 'unsafe-inline'\n- img-src 'self' data:\n\nFILE: gleam/src/meal_planner/web.gleam (middleware)\n\nVERIFY: Check browser console shows no CSP violations\nSOURCE: HTMX_CODE_REVIEW.md Security Recommendations","notes":"CSP headers implementation created but needs integration with current web module structure","status":"in_progress","priority":3,"issue_type":"task","created_at":"2025-12-05T03:53:57.426443346Z","updated_at":"2025-12-13T13:36:59.653340271Z","dependencies":[{"issue_id":"meal-planner-9j9q","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.579972278Z","created_by":"daemon"}]}
{"id":"meal-planner-9q42","title":"Refactor web.gleam into modular structure","description":"Split web.gleam (1,918 lines) into: web/handlers/ (home, recipes, foods, dashboard, logs), web/api/ (recipes, foods, logs, profile), web/rendering/ (layout, helpers, errors). Target: \u003c300 lines per file.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T22:59:31.542095925Z","updated_at":"2025-12-05T05:40:32.916173167Z"}
{"id":"meal-planner-agy7","title":"Add scheduler actor module","description":"Create OTP actor with send_after loop. Wakes every hour, checks if Sunday 8 PM, triggers email send if true, re-schedules next wake. Use process.send_after pattern. Verify: gleam build passes. Files: gleam/src/meal_planner/actors/scheduler_actor.gleam","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-04T15:40:19.68240883Z","updated_at":"2025-12-04T15:40:19.68240883Z"}
{"id":"meal-planner-aj6f","title":"Refactor: Extract method for duplicate error handling patterns","description":"Martin Fowler principle: Extract Method. Found duplicate error handling patterns across storage.gleam, web.gleam, and auto_planner.gleam. Pattern: case Result { Error(e) -\u003e Error(DatabaseError(...)), Ok(x) -\u003e ... }. Extract to reusable result_to_storage_error() helper. Improves: DRY, testability, maintainability. Files: src/meal_planner/storage.gleam, src/meal_planner/result_helpers.gleam (new). Impact: Reduces 50+ duplicate lines.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T03:44:32.157774545Z","updated_at":"2025-12-04T03:44:32.157774545Z","dependencies":[{"issue_id":"meal-planner-aj6f","depends_on_id":"meal-planner-rvjb","type":"blocks","created_at":"2025-12-04T03:48:21.797065349Z","created_by":"daemon"}]}
{"id":"meal-planner-atfe","title":"Wire scheduler to email sending","description":"Update scheduler actor to: 1) Call get_weekly_summary, 2) Call render_weekly_email, 3) Call send_email. Add error logging. Integrates scheduler + email template + summary query + SMTP. Verify: manual test or mock time. Files: gleam/src/meal_planner/actors/scheduler_actor.gleam","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T15:40:19.719292433Z","updated_at":"2025-12-04T15:40:19.719292433Z","dependencies":[{"issue_id":"meal-planner-atfe","depends_on_id":"meal-planner-agy7","type":"blocks","created_at":"2025-12-04T15:40:33.357515926Z","created_by":"daemon"},{"issue_id":"meal-planner-atfe","depends_on_id":"meal-planner-i96s","type":"blocks","created_at":"2025-12-04T15:40:33.365014874Z","created_by":"daemon"},{"issue_id":"meal-planner-atfe","depends_on_id":"meal-planner-mvjz","type":"blocks","created_at":"2025-12-04T15:40:33.373012518Z","created_by":"daemon"},{"issue_id":"meal-planner-atfe","depends_on_id":"meal-planner-ji68","type":"blocks","created_at":"2025-12-04T15:40:33.38002119Z","created_by":"daemon"}]}
{"id":"meal-planner-b9t","title":"Remove old temp files from root","description":"Remove: .beads/issues.jsonl.backup, test_results.log, MIGRATION_010_FILES.txt, PERFORMANCE_ANALYSIS_SUMMARY.txt","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:21.789610831Z","updated_at":"2025-12-13T13:31:08.690078911Z","closed_at":"2025-12-13T13:31:08.690078911Z"}
{"id":"meal-planner-bn3","title":"Email notifications for weekly summary and NCP alerts","description":"Automated emails via Mailtrap for weekly summaries and nutrition reconciliation.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-01T02:45:59.621470598-06:00","updated_at":"2025-12-01T02:45:59.621470598-06:00","dependencies":[{"issue_id":"meal-planner-bn3","depends_on_id":"meal-planner-g8s","type":"parent-child","created_at":"2025-12-01T02:51:28.303022334-06:00","created_by":"lewis"}]}
{"id":"meal-planner-d18t","title":"Code smell: Primitive obsession in recipe nutrition data","description":"Martin Fowler smell: Primitive Obsession. Passing individual Float values for protein/fat/carbs everywhere. Create MacroNutrients type: MacroNutrients(protein: Float, fat: Float, carbs: Float, calories: Float). Benefits: Type safety, grouped related data, self-documenting, prevents parameter order mistakes. Files: src/meal_planner/types.gleam, 20+ files using primitives.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T03:44:41.751454986Z","updated_at":"2025-12-04T03:44:41.751454986Z","dependencies":[{"issue_id":"meal-planner-d18t","depends_on_id":"meal-planner-4gc9","type":"blocks","created_at":"2025-12-04T03:49:05.197426283Z","created_by":"daemon"}]}
{"id":"meal-planner-e0v","title":"Performance optimization","description":"Optimize database queries with indexes, add caching for search results, lazy load components","notes":"Multi-agent coordination completed. 3 agents analyzed and designed implementations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-03T02:55:04.649452724Z","updated_at":"2025-12-13T13:37:06.625790211Z","closed_at":"2025-12-13T13:37:06.625790211Z"}
{"id":"meal-planner-g8s","title":"Meal Planner Web Application MVP","description":"Complete web application with meal logging, recipe management, weekly planning, email notifications, user auth, and mobile-responsive UI","status":"open","priority":0,"issue_type":"epic","created_at":"2025-12-01T02:50:45.99565506-06:00","updated_at":"2025-12-01T02:50:45.99565506-06:00"}
{"id":"meal-planner-go8i","title":"Consolidate documentation into main README","description":"After deleting 110 redundant markdown files, identified need to consolidate remaining important documentation into main README.md. See meal-planner-b102 for tracking. Ensures developers have single source of truth.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-04T03:30:18.485962088Z","updated_at":"2025-12-13T13:33:19.369832366Z","closed_at":"2025-12-13T13:33:19.369832366Z"}
{"id":"meal-planner-gzj","title":"Truncate beads daemon logs","description":"Truncate .beads/daemon.log (18MB) to prevent excessive disk usage","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:20.81472641Z","updated_at":"2025-12-13T13:31:07.539865766Z","closed_at":"2025-12-13T13:31:07.539865766Z"}
{"id":"meal-planner-hv7c","title":"Implement log_food_form page with portion and meal selection","description":"Create handler for /log/food/{id} route that displays USDA food details and provides form to select portion size (grams) and meal type (breakfast/lunch/dinner/snack). Should look similar to log_meal_form but for USDA foods.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-03T22:35:42.471083476Z","updated_at":"2025-12-13T13:36:12.126952927Z","closed_at":"2025-12-13T13:36:12.126952927Z"}
{"id":"meal-planner-i1y3","title":"Update CLAUDE.md with worktree pool workflow instructions","description":"Main CLAUDE.md needs section documenting how to use the worktree pool: acquiring worktrees, working in isolation, releasing, scaling. Reference scripts/worktree-pool-manager.sh, resource-monitor.sh, beads-track-analyzer.sh.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-05T04:32:38.089509434Z","updated_at":"2025-12-13T13:33:19.375572013Z","closed_at":"2025-12-13T13:33:19.375572013Z"}
{"id":"meal-planner-i96s","title":"Add email template function","description":"Create email_templates.gleam with render_weekly_email(summary_data) function. Plain HTML email template showing: total logs, avg macros, top foods. Returns HTML string. Verify: gleam build passes. Files: gleam/src/meal_planner/ui/email_templates.gleam","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T15:40:19.692052237Z","updated_at":"2025-12-04T15:40:19.692052237Z"}
{"id":"meal-planner-j0on","title":"Add API endpoint for logging USDA foods with micronutrients","description":"Create POST /api/logs/food endpoint that accepts fdc_id, grams, and meal_type. Calculate macros and ALL micronutrients proportionally from USDA data (per 100g → actual grams). Save to food_logs with source_type='usda_food'.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-03T22:35:44.030170881Z","updated_at":"2025-12-13T13:36:13.067968371Z","closed_at":"2025-12-13T13:36:13.067968371Z"}
{"id":"meal-planner-ji68","title":"Add SMTP wrapper module","description":"Create smtp_client.gleam with send_email(to, subject, html_body) function. Use gen_smtp via FFI or HTTP mail API. Handle errors with Result type. Verify: gleam build passes. Files: gleam/src/meal_planner/integrations/smtp_client.gleam","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T15:40:19.70923719Z","updated_at":"2025-12-04T15:40:19.70923719Z"}
{"id":"meal-planner-jou4","title":"Apply Migration 010 - Search Performance Optimization","description":"Apply 010_optimize_search_performance.sql to production\n\nCREATES: 5 performance indexes\nEXPECTED: 30-50% faster queries, CPU 60%→30%\n\nSTEPS:\n1. Backup database\n2. Apply migration\n3. Verify indexes created\n4. Validate query plans\n5. Monitor 24hrs\n\nVERIFY: Queries from OPTIMIZATION_IMPLEMENTATION_CHECKLIST.md\nROLLBACK: Drop indexes documented\nSOURCE: MIGRATION_STATUS.md","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-05T03:52:33.214158166Z","updated_at":"2025-12-13T13:36:58.446889965Z","closed_at":"2025-12-13T13:36:58.446889965Z","dependencies":[{"issue_id":"meal-planner-jou4","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.495408414Z","created_by":"daemon"}]}
{"id":"meal-planner-jznn","title":"Fix Vertical Diet recipe insertion","description":"6 beef/bison recipes failing to insert with 'Database connection unavailable' error - need to debug database connection in test environment","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-04T22:29:46.53100778Z","updated_at":"2025-12-13T13:36:05.270219913Z","closed_at":"2025-12-13T13:36:05.270219913Z"}
{"id":"meal-planner-kznh","title":"Add rate limiting to search API endpoints","description":"Prevent abuse/DoS attacks on search endpoints\n\nENDPOINTS TO PROTECT:\n- /api/foods/search\n- /api/foods\n\nIMPLEMENTATION:\n1. Track requests per IP/session\n2. Limit: 100 requests per minute\n3. Return 429 Too Many Requests when exceeded\n4. Add Retry-After header\n\nLIBRARY: Consider using gleam rate limiting lib or implement with ETS\n\nVERIFY: Spam requests get 429 response\nSOURCE: HTMX_CODE_REVIEW.md Security Recommendations","notes":"Rate limiting module created but needs integration with current request handling","status":"in_progress","priority":3,"issue_type":"task","created_at":"2025-12-05T03:53:55.643869175Z","updated_at":"2025-12-13T13:36:59.659174129Z","dependencies":[{"issue_id":"meal-planner-kznh","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.573654623Z","created_by":"daemon"}]}
{"id":"meal-planner-lt58","title":"UI components return String but should return Lustre Element(msg)","description":"ANALYSIS COMPLETE:\n\nComponent library (src/meal_planner/ui/components/*.gleam) returns String but comments say 'Lustre HTML elements'. This is intentional mismatch:\n\nTWO ARCHITECTURES COEXIST:\n1. web.gleam: Uses Lustre Element(msg) - current working server\n2. ui/pages + ui/components: Return String for SSR - not yet integrated\n\nSOLUTION OPTIONS:\nA. Convert components to Element(msg) - breaks 43 tests, large refactor\nB. Keep String, add wrapper - need element.dangerous_unescaped_fragment\nC. Parallel APIs - code duplication\n\nRECOMMENDED: Option A - matches documented intent, type-safe, SSR via element.to_string()\n\nBLOCKER: PinkDog has broad file reservations on gleam/src/**/*.gleam and gleam/test/**/*.gleam preventing work.\n\nDEPENDENCIES: meal-planner-uzr (Dashboard integration) blocked by this.","status":"blocked","priority":1,"issue_type":"bug","created_at":"2025-12-03T22:52:20.680598364Z","updated_at":"2025-12-03T22:55:54.487301858Z"}
{"id":"meal-planner-m8sw","title":"Re-enable and fix auto_planner_trigger_test.gleam","description":"Fix 100 type mismatch errors in auto_planner_trigger_test.gleam. Tests expect String but get element.Element(a) from render functions. Need to wrap render output in element.to_string() or update test assertions. File currently renamed to .disabled","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-04T22:29:37.322571292Z","updated_at":"2025-12-13T13:32:03.883300506Z","closed_at":"2025-12-13T13:32:03.883300506Z"}
{"id":"meal-planner-m9z9","title":"[Extract Method] Step 3: Replace 10 patterns in storage.gleam","description":"Replace first 10 duplicate error patterns in storage.gleam with result_to_storage_error() helper. Run gleam test after each replacement. Verify: All storage tests pass. Time: 45min. Files: src/meal_planner/storage.gleam. Deliverable: -20 lines, same behavior.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T03:47:09.240146359Z","updated_at":"2025-12-04T03:47:09.240146359Z","dependencies":[{"issue_id":"meal-planner-m9z9","depends_on_id":"meal-planner-4qic","type":"blocks","created_at":"2025-12-04T03:48:21.811221256Z","created_by":"daemon"}]}
{"id":"meal-planner-mb9v","title":"Implement storage API functions in ncp_auto_planner.gleam","description":"File: gleam/src/meal_planner/ncp_auto_planner.gleam\n\nTODO: Implement 4 storage functions:\n1. get_user_profile_by_id() - Load user preferences\n2. get_recipes_by_category() - Filter recipes\n3. get_random_recipe() - Select meal\n4. save_meal_plan() - Persist generated plan\n\nCURRENT: Returns mock data\nNEEDED: Actual database queries\n\nVERIFY: Auto planner generates real meal plans from DB\nSOURCE: 4 TODO comments in file","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-05T03:53:06.062778736Z","updated_at":"2025-12-05T03:53:06.062778736Z","dependencies":[{"issue_id":"meal-planner-mb9v","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.534735665Z","created_by":"daemon"}]}
{"id":"meal-planner-mf2k","title":"Document fractal quality loop workflow","description":"Create FRACTAL_QUALITY_LOOP.md with 4-pass workflow diagram (unit → integration → E2E → review), truth score calculation formula (average of 4 passes), examples of good (\u003e=0.95) and bad (\u003c0.95) scores, how to interpret auto-rollback. Verify: Manual review. Files: docs/FRACTAL_QUALITY_LOOP.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:15:07.577764954Z","updated_at":"2025-12-13T13:33:19.364257226Z","closed_at":"2025-12-13T13:33:19.364257226Z"}
{"id":"meal-planner-mgo","title":"Micronutrient visualization","description":"Add vitamin/mineral tracking displays with daily value percentages","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T02:55:02.838947431Z","updated_at":"2025-12-03T23:46:51.335732805Z"}
{"id":"meal-planner-mvjz","title":"Add weekly_summary storage query","description":"Add get_weekly_summary(user_id, start_date) function. SQL aggregates: COUNT logs, AVG macros, GROUP BY food for last 7 days. Return Summary struct. Verify: test with mock data. Files: gleam/src/meal_planner/storage.gleam","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T15:40:19.701306758Z","updated_at":"2025-12-04T15:40:19.701306758Z"}
{"id":"meal-planner-mxdc","title":"Evolutionary design: Add property-based tests for macro calculations","description":"Martin Fowler principle: Evolutionary Design needs strong test foundation. Add QuickCheck property tests for: total_macros(recipes) \u003e= sum(individual_macros), calories = 4*protein + 4*carbs + 9*fat, percentage calculations sum to 100%. Benefits: Catches edge cases, mathematical correctness, confidence for refactoring. Files: test/meal_planner/macros_properties_test.gleam (new).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:44:42.618552852Z","updated_at":"2025-12-13T13:36:51.109305548Z","closed_at":"2025-12-13T13:36:51.109305548Z","dependencies":[{"issue_id":"meal-planner-mxdc","depends_on_id":"meal-planner-7zzg","type":"blocks","created_at":"2025-12-04T03:49:06.365417478Z","created_by":"daemon"}]}
{"id":"meal-planner-n0s7","title":"[Property Tests] Step 3: Write macro aggregation property test","description":"Property: total_macros(recipes) \u003e= sum(individual_macros). Test with lists of 1-20 recipes. Time: 30min. Files: test/meal_planner/properties/aggregation_test.gleam (new, \u003c80 LOC).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:48:44.898221433Z","updated_at":"2025-12-13T13:32:36.548610908Z","closed_at":"2025-12-13T13:32:36.548610908Z"}
{"id":"meal-planner-n5d","title":"Remove gleam/docs folder","description":"Remove gleam/docs/ directory (3 markdown files, 32KB)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:22.816055267Z","updated_at":"2025-12-13T13:31:09.342260794Z","closed_at":"2025-12-13T13:31:09.342260794Z"}
{"id":"meal-planner-ocfx","title":"Code smell: Divergent change in web.gleam (1000+ lines)","description":"Martin Fowler smell: Divergent Change / Large Class. web.gleam has 1000+ lines handling: routing, handlers, decoders, HTML rendering. Split into: routes.gleam (routing), handlers/*.gleam (by feature), decoders.gleam (JSON), renderers.gleam (HTML). Benefits: Single Responsibility Principle, easier navigation, parallel development. Files: src/meal_planner/web/*.gleam (new structure).","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-04T03:44:39.26472424Z","updated_at":"2025-12-04T20:32:07.140347454Z"}
{"id":"meal-planner-p4d0","title":"Run final test suite and generate 90% coverage report","description":"After all tests are created, run the complete test suite with coverage reporting to verify 90% coverage target is met. Document results.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T23:27:14.284343176Z","updated_at":"2025-12-05T05:40:25.918188393Z"}
{"id":"meal-planner-pio5","title":"Test coverage: diet_validator module - Write comprehensive Gleam tests","description":"Cannot write tests: PinkDog has broad file reservations on gleam/test/**/*.gleam (expires 00:55 UTC). Need coordination or wait for expiry.","status":"blocked","priority":1,"issue_type":"task","created_at":"2025-12-03T22:55:30.046616661Z","updated_at":"2025-12-03T23:04:17.909137836Z"}
{"id":"meal-planner-qefc","title":"Add TodoistActor module","description":"Create OTP actor for Todoist sync. Message types: {Sync, Retry, Stop}. State: {sync_queue: List, retry_count: Int}. Implement init, handle_message functions. Handles Sync message by calling HTTP client. Verify: gleam build passes. Files: gleam/src/meal_planner/actors/todoist_actor.gleam","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-04T15:40:17.834366812Z","updated_at":"2025-12-04T15:40:17.834366812Z"}
{"id":"meal-planner-rvjb","title":"[Extract Method] Step 4: Replace patterns in web.gleam and auto_planner.gleam","description":"Replace remaining 40+ patterns in web.gleam and auto_planner.gleam. Run gleam test after each file. Verify: All tests pass. Time: 1 hour. Files: src/meal_planner/web.gleam, src/meal_planner/auto_planner.gleam. Deliverable: -30 lines total.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-04T03:47:10.27811781Z","updated_at":"2025-12-04T03:47:10.27811781Z","dependencies":[{"issue_id":"meal-planner-rvjb","depends_on_id":"meal-planner-m9z9","type":"blocks","created_at":"2025-12-04T03:48:21.804151742Z","created_by":"daemon"}]}
{"id":"meal-planner-t7l","title":"Remove gleam/examples folder","description":"Remove gleam/examples/ directory (6 files, 68KB)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:25.963039306Z","updated_at":"2025-12-13T13:31:10.827926822Z","closed_at":"2025-12-13T13:31:10.827926822Z"}
{"id":"meal-planner-tkrt","title":"[Extract Method] Step 1: Identify duplicate error patterns with grep","description":"Run grep to find all duplicate 'case Result { Error(e) -\u003e Error(DatabaseError' patterns. Document locations, count occurrences. Output: error_patterns.md with file:line numbers. Time: 15min. Files: storage.gleam, web.gleam, auto_planner.gleam. Deliverable: List of 50+ duplicate locations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T03:47:07.45882237Z","updated_at":"2025-12-13T13:31:17.113439356Z","closed_at":"2025-12-13T13:31:17.113439356Z"}
{"id":"meal-planner-u07a","title":"Fix broken test files from auto planner swarm","description":"Two test files disabled in commit a084b4a need fixing: ncp_auto_planner_test.gleam (36 operator precedence errors - \u003c. operator split across lines) and auto_planner_trigger_test.gleam (100 type mismatch errors). These were created by previous swarm and have syntax issues preventing build.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-04T22:29:33.04773399Z","updated_at":"2025-12-13T13:32:02.751353422Z","closed_at":"2025-12-13T13:32:02.751353422Z"}
{"id":"meal-planner-uaio","title":"Add HTMX integration tests for full request cycle","description":"Create integration tests for HTMX search flows\n\nTESTS NEEDED:\n1. search_with_filters_integration_test\n2. invalid_query_returns_error_test\n3. filter_chip_click_updates_results_test\n4. category_dropdown_change_updates_results_test\n5. loading_indicator_shows_during_request_test\n\nFILE: gleam/test/meal_planner/integration/htmx_search_integration_test.gleam\n\nVERIFY: gleam test passes with 5 new integration tests\nSOURCE: HTMX_CODE_REVIEW.md line 773 (Priority 3)","notes":"HTMX integration tests created - needs test infrastructure setup","status":"in_progress","priority":3,"issue_type":"task","created_at":"2025-12-05T03:53:24.391173942Z","updated_at":"2025-12-13T13:36:59.668789493Z","dependencies":[{"issue_id":"meal-planner-uaio","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.547592823Z","created_by":"daemon"}]}
{"id":"meal-planner-uzr","title":"Nutrition dashboard redesign","description":"Dashboard UI foundation ready: Progress bars, stat cards, layout components implemented. Ready for page integration.","status":"blocked","priority":1,"issue_type":"task","created_at":"2025-12-03T02:54:45.075956388Z","updated_at":"2025-12-03T22:52:30.742169076Z"}
{"id":"meal-planner-uzr.2","title":"Macro progress bars","description":"Create protein, fat, carbs progress bars with color coding (blue/orange/green), labels, current/target values, and smooth fill animations (0.6s ease-out).","status":"in_progress","priority":1,"issue_type":"task","assignee":"RedCreek","created_at":"2025-12-03T03:25:11.563936026Z","updated_at":"2025-12-03T23:42:28.369080003Z","dependencies":[{"issue_id":"meal-planner-uzr.2","depends_on_id":"meal-planner-uzr","type":"parent-child","created_at":"2025-12-03T03:25:11.564201963Z","created_by":"daemon"}]}
{"id":"meal-planner-vc4d","title":"Fix database naming inconsistency (wt-4 vs wt4)","description":"Worktree wt-4 has DATABASE_NAME=meal_planner_wt-4 (with dash) but database is meal_planner_wt4 (no dash). Need to standardize - either fix env file or create meal_planner_wt-4 database.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-05T04:32:28.513250011Z","updated_at":"2025-12-13T13:36:03.16645496Z","closed_at":"2025-12-13T13:36:03.16645496Z"}
{"id":"meal-planner-vj4x","title":"Implement micronutrient goals and targets in user profile","description":"Users can track micronutrients but can't set targets/goals (e.g., RDA for vitamins).\n\n**What's Needed:**\n- Add micronutrient_goals to user_profile table\n- Structure: JSON or 21 columns for each micronutrient target\n- Default to FDA RDA values\n- Allow users to customize per micronutrient\n\n**Implementation:**\n- Migration: ALTER TABLE user_profiles ADD COLUMN micronutrient_goals TEXT (JSON)\n- Type: MicronutrientGoals (same structure as Micronutrients)\n- Storage: save/load goals with user profile\n- UI: Settings page to configure targets","acceptance_criteria":"- [ ] user_profiles table has micronutrient_goals column\n- [ ] MicronutrientGoals type defined\n- [ ] Default RDA values populated on profile creation\n- [ ] Dashboard shows progress vs goals (not just absolute values)\n- [ ] Settings UI allows editing goals","notes":"Backend complete but web UI removed in major redesign. Re-evaluate when building new UI.","status":"blocked","priority":4,"issue_type":"feature","created_at":"2025-12-03T14:47:19.094507747Z","updated_at":"2025-12-12T11:41:28.93249637Z"}
{"id":"meal-planner-weir","title":"Implement Todoist API synchronization in todoist_client.gleam","description":"File: gleam/src/meal_planner/integrations/todoist_client.gleam\n\nCURRENT: Returns Ok() stub, no actual Todoist API calls\nTODO: Implement actual Todoist API synchronization\n\nFEATURES:\n- Create tasks in Todoist\n- Sync meal plans to tasks\n- Handle API authentication\n- Error handling\n\nVERIFY: Tasks appear in Todoist\nSOURCE: Code TODO comment","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-05T03:53:05.320740395Z","updated_at":"2025-12-05T03:53:05.320740395Z","dependencies":[{"issue_id":"meal-planner-weir","depends_on_id":"meal-planner-3yah","type":"blocks","created_at":"2025-12-05T03:54:23.528151054Z","created_by":"daemon"}]}
{"id":"meal-planner-x4e2","title":"Add micronutrient daily summary to dashboard","description":"Display comprehensive daily micronutrient totals on dashboard including: fiber, sugar, sodium, cholesterol, vitamins (A, C, D, E, K, B6, B12, folate, thiamin, riboflavin, niacin), minerals (calcium, iron, magnesium, phosphorus, potassium, zinc). Show current vs recommended daily values.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-03T22:35:45.530195874Z","updated_at":"2025-12-03T22:35:45.530195874Z","dependencies":[{"issue_id":"meal-planner-x4e2","depends_on_id":"meal-planner-j0on","type":"blocks","created_at":"2025-12-03T22:44:59.077333792Z","created_by":"daemon"}]}
{"id":"meal-planner-y66","title":"Remove scripts docs","description":"Remove scripts/README.md, scripts/CHANGES.md, scripts/PRE_COMMIT_HOOK.md (21KB)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T13:22:23.465578415Z","updated_at":"2025-12-13T13:31:10.077235688Z","closed_at":"2025-12-13T13:31:10.077235688Z"}
{"id":"meal-planner-zxqz","title":"Refactor storage.gleam by domain","description":"Split storage.gleam (1,904 lines) into: storage/mod.gleam (public API), storage/recipes.gleam, storage/foods.gleam, storage/logs.gleam, storage/profile.gleam, storage/nutrients.gleam, storage/migrations.gleam. Domain-driven organization.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-03T22:59:33.225315095Z","updated_at":"2025-12-05T05:40:28.497304841Z"}
