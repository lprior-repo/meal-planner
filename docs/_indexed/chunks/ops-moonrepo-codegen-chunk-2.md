---
doc_id: ops/moonrepo/codegen
chunk_id: ops/moonrepo/codegen#chunk-2
heading_path: ["Code generation", "Creating a new template"]
chunk_type: code
tokens: 1171
summary: "Creating a new template"
---

## Creating a new template

To create a new template, run [`moon generate`](/docs/commands/generate) while passing the `--template` option. This will create a template directory and [`template.yml`](/docs/config/template) file in the 1st file-based template location defined in [`generator.templates`](/docs/config/workspace#templates).

```shell
$ moon generate <name> --template
```

### Configuring `template.yml`

Every template requires a [`template.yml`](/docs/config/template) file in the template's directory root. This file acts as a schema and declares metadata and variables required by the generator.

template.yml

```yaml
title: 'npm package'
description: |
  Scaffolds the initial structure for an npm package,
  including source and test folders, a package.json, and more.
variables:
  name:
    type: 'string'
    default: ''
    required: true
    prompt: 'Package name?'
```

### Managing files

Feel free to add any files and folders to the template that you'd like to be generated by consumers! These files will then be scaffolded 1:1 in structure at the target destination.

An example of the templates folder structure may look something like the following:

```
templates/
├── npm-package/
│   ├── src/
│   ├── tests/
│   ├── package.json
│   └── template.yml
└── react-app/
```

#### Interpolation

Variables can be interpolated into file paths using the form `[varName]`. For example, if you had a template file `src/[type].ts`, and a variable `type` with a value of "bin", then the destination file path would be `src/bin.ts`.

This syntax also supports [filters](#filters), such as `[varName | camel_case]`. However, spaces may cause issues with file path encoding, so this functionality is primarily recommended for the [`destination`](/docs/config/template#destination) setting.

#### File extensions

To enable syntax highlighting for template engine syntax, you may use the `.tera` (preferred) or `.twig` file extensions. These extensions are optional, but will be removed when the files are generated.

Depending on your preferred editor, these extensions may be supported through a plugin, or can be configured based on file type.

- **VS Code**
  - [Tera extension](https://marketplace.visualstudio.com/items?itemName=karunamurti.tera)
  - [Twig extension](https://marketplace.visualstudio.com/items?itemName=mblode.twig-language-2)
- **Atom**
  - [Twig package](https://atom.io/packages/atom-twig)
- **Webstorm**
  - [Twig plugin](https://plugins.jetbrains.com/plugin/7303-twig)

#### Partials

Partials are special template files that are used for [composition](https://keats.github.io/tera/docs/#include) and [inheritance](https://keats.github.io/tera/docs/#inheritance). Because of this, these files *should not* be generated into the target destination, and *do not* support frontmatter.

To ensure they are not generated, include the word "partial" anywhere in the file path. For example, `partials/header.tpl` or `header.partial.tpl`.

#### Raws (v1.11.0)

Raw template files are another special type of file that bypass all Tera rendering, and are used as-is instead. This is useful for files that contain syntax that conflicts with Tera.

To mark a file as raw, add a `.raw` extension, for example: `file.raw.js` or `file.js.raw`. When the file is generated, the `.raw` extension will be removed.

#### Frontmatter

Frontmatter is a well-known concept for "per-file configuration", and is achieved by inserting YAML at the top of the file, delimited by wrapping `---`. This is a very powerful feature that provides more control than the alternatives, and allows for some very cool integrations.

moon's frontmatter supports functionality like file skipping, force overwriting, and destination path rewriting. [View the configuration docs for a full list of supported fields](/docs/config/template#frontmatter).

package.json

```
---
force: true
---
{
  "name": "{{ name | kebab_case }}",
  "version": "0.0.1"
}
```

Since frontmatter exists in the file itself, you can take advantage of the rendering engine to populate the field values dynamically. For example, if you're scaffolding a React component, you can convert the component name and file name to PascalCase.

```
{% set component_name = name | pascal_case %}
---
to: components/{{ component_name }}.tsx
---
export function {{ component_name }}() {
  return <div />;
}
```

#### Assets

Assets are binary files that are copied as-is to the destination, without any rendering, and no support for frontmatter. This applies to all non-text based files, like images, audio, video, etc.

### Template engine & syntax

Rendering templates is powered by [Tera](https://keats.github.io/tera/), a Rust based template engine with syntax similar to Twig, Liquid, Django, and more. We highly encourage everyone to read Tera's documentation for an in-depth understanding, but as a quick reference, Tera supports the following:

- [Variable interpolation](https://keats.github.io/tera/docs/#variables) (defined with the [`variables`](/docs/config/template#variables) setting), with [built-in filters](https://keats.github.io/tera/docs/#built-in-filters).

```
{{ varName }} -> foo
{{ varName | upper }} -> FOO
```

- [Conditional blocks](https://keats.github.io/tera/docs/#if) and [loops](https://keats.github.io/tera/docs/#for).

```
{% if price < 10 or always_show %}
  Price is {{ price }}.
{% elif price > 1000 and not rich %}
  That's expensive!
{% else %}
  N/A
{% endif %}
```

```
{% for item in items %}
  {{ loop.index }} - {{ item.name }}
{% endfor %}
```

- And many more features, like auto-escaping, white space control, and math operators!

#### Filters

Filters are a mechanism for transforming values during interpolation and are written using pipes (`|`). Tera provides many [built-in filters](https://keats.github.io/tera/docs/#built-in-filters), but we also provide the following custom filters:

- Strings - `camel_case`, `pascal_case`, `snake_case`, `upper_snake_case`, `kebab_case`, `upper_kebab_case`, `lower_case`, `upper_case`

```
{{ some_value | upper_case }}
```

- Paths - `path_join`, `path_relative`

```
{{ some_path | path_join(part = "another/folder") }}
{{ some_path | path_relative(from = other_path) }}
{{ some_path | path_relative(to = other_path) }}
```

#### Functions

The following functions are available within a template:

- `variables()` - Returns an object containing all variables within the current template. (v1.23.0)

#### Variables

The following variables are always available within a template:

- `dest_dir` - Absolute path to the destination folder.
- `dest_rel_dir` - Relative path to the destination folder from the working directory.
- `working_dir` - Current working directory.
- `workspace_root` - The moon workspace root.
