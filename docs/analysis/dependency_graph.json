{
  "analysis_date": "2025-12-03",
  "project": "/home/lewis/src/meal-planner",
  "summary": {
    "total_gleam_files": 41,
    "total_typescript_files": 5,
    "total_javascript_files": 1,
    "total_imports": 196,
    "public_exports": 298,
    "orphaned_modules": 0,
    "circular_dependencies": []
  },
  "gleam_modules": {
    "meal_planner": {
      "path": "gleam/src/meal_planner.gleam",
      "imports": ["gleam/io", "meal_planner/application", "meal_planner/web"],
      "exports": ["main"],
      "imported_by": [],
      "status": "entry_point"
    },
    "meal_planner/web": {
      "path": "gleam/src/meal_planner/web.gleam",
      "imports": [
        "gleam/dynamic/decode",
        "gleam/erlang/process",
        "gleam/float",
        "gleam/http",
        "gleam/int",
        "gleam/io",
        "gleam/json",
        "gleam/list",
        "gleam/option",
        "gleam/result",
        "gleam/string",
        "gleam/uri",
        "lustre/attribute",
        "lustre/element",
        "lustre/element/html",
        "meal_planner/storage",
        "meal_planner/web_helpers",
        "shared/types",
        "mist",
        "pog",
        "wisp",
        "wisp/wisp_mist"
      ],
      "exports": ["start_server", "handle_request", "middleware"],
      "imported_by": ["meal_planner"],
      "status": "active"
    },
    "meal_planner/storage": {
      "path": "gleam/src/meal_planner/storage.gleam",
      "imports": [
        "gleam/dynamic/decode",
        "gleam/erlang/process",
        "gleam/int",
        "gleam/list",
        "gleam/option",
        "gleam/otp/actor",
        "gleam/string",
        "meal_planner/ncp",
        "shared/types",
        "pog"
      ],
      "exports": [
        "StorageError",
        "start",
        "save_food_log",
        "get_food_logs_by_date",
        "search_foods",
        "get_recipe_by_id",
        "list_recipes"
      ],
      "imported_by": ["meal_planner/web", "meal_planner/food_search"],
      "status": "active"
    },
    "meal_planner/auto_planner": {
      "path": "gleam/src/meal_planner/auto_planner.gleam",
      "imports": [
        "gleam/float",
        "gleam/int",
        "gleam/list",
        "gleam/result",
        "gleam/string",
        "meal_planner/auto_planner/types",
        "meal_planner/diet_validator",
        "shared/types"
      ],
      "exports": [
        "RecipeScore",
        "filter_by_diet_principles",
        "calculate_macro_match_score",
        "calculate_variety_score",
        "score_recipe",
        "select_top_n",
        "generate_auto_plan"
      ],
      "imported_by": [],
      "status": "newly_created_possibly_unused"
    },
    "meal_planner/auto_planner/types": {
      "path": "gleam/src/meal_planner/auto_planner/types.gleam",
      "imports": [
        "gleam/json",
        "gleam/list",
        "gleam/option",
        "shared/types",
        "gleam/dynamic/decode"
      ],
      "exports": [
        "DietPrinciple",
        "AutoPlanConfig",
        "AutoMealPlan",
        "encode_auto_plan",
        "decode_auto_plan"
      ],
      "imported_by": ["meal_planner/auto_planner"],
      "status": "active"
    },
    "meal_planner/auto_planner/storage": {
      "path": "gleam/src/meal_planner/auto_planner/storage.gleam",
      "imports": [
        "gleam/dynamic/decode",
        "gleam/int",
        "gleam/list",
        "gleam/option",
        "gleam/string",
        "meal_planner/auto_planner/types",
        "meal_planner/storage",
        "pog",
        "shared/types",
        "gleam/json"
      ],
      "exports": [
        "save_auto_plan",
        "get_auto_plan_by_id",
        "list_auto_plans"
      ],
      "imported_by": [],
      "status": "newly_created_possibly_unused"
    },
    "meal_planner/ui/recipe_form": {
      "path": "gleam/src/meal_planner/ui/recipe_form.gleam",
      "imports": ["gleam/string_builder"],
      "exports": ["render_form"],
      "imported_by": [],
      "status": "newly_created_unused",
      "note": "Generates HTML form but not yet integrated into web routes"
    },
    "meal_planner/ui/pages/dashboard": {
      "path": "gleam/src/meal_planner/ui/pages/dashboard.gleam",
      "imports": ["gleam/option"],
      "exports": ["render_dashboard"],
      "imported_by": [],
      "status": "stub_implementation",
      "todo_count": 9,
      "note": "Contains placeholder TODO comments, not implemented"
    },
    "meal_planner/ui/pages/food_search": {
      "path": "gleam/src/meal_planner/ui/pages/food_search.gleam",
      "imports": ["gleam/option"],
      "exports": ["render_food_search_page"],
      "imported_by": [],
      "status": "stub_implementation",
      "todo_count": 7,
      "note": "Contains placeholder TODO comments, not implemented"
    },
    "meal_planner/ui/components/forms": {
      "path": "gleam/src/meal_planner/ui/components/forms.gleam",
      "imports": ["gleam/option"],
      "exports": [
        "input",
        "textarea",
        "select",
        "checkbox",
        "radio",
        "form_group",
        "validation_message"
      ],
      "imported_by": [],
      "status": "stub_implementation",
      "todo_count": 8,
      "note": "All functions return dummy strings with TODO"
    },
    "meal_planner/state": {
      "path": "gleam/src/meal_planner/state.gleam",
      "imports": [
        "gleam/erlang/process",
        "gleam/option",
        "gleam/otp/actor",
        "gleam/otp/supervision",
        "meal_planner/ncp",
        "shared/types"
      ],
      "exports": ["AppState", "start", "get_profile", "update_profile"],
      "imported_by": [],
      "status": "unused_deprecated",
      "note": "State management not used, web is stateless with storage actor"
    },
    "meal_planner/output": {
      "path": "gleam/src/meal_planner/output.gleam",
      "imports": [
        "gleam/float",
        "gleam/int",
        "gleam/io",
        "gleam/list",
        "gleam/string",
        "meal_planner/env",
        "meal_planner/meal_plan",
        "meal_planner/shopping_list",
        "shared/types"
      ],
      "exports": [
        "print_daily_meal_plan",
        "print_shopping_list",
        "print_weekly_summary"
      ],
      "imported_by": [],
      "status": "cli_only_unused_in_web",
      "note": "CLI output functions not used in web app"
    },
    "meal_planner/weekly_plan": {
      "path": "gleam/src/meal_planner/weekly_plan.gleam",
      "imports": [
        "gleam/list",
        "meal_planner/meal_plan",
        "meal_planner/meal_selection",
        "meal_planner/portion",
        "shared/types"
      ],
      "exports": ["generate_weekly_meal_plan"],
      "imported_by": [],
      "status": "cli_only_unused_in_web",
      "note": "Weekly planning not integrated in web routes"
    },
    "meal_planner/user_profile": {
      "path": "gleam/src/meal_planner/user_profile.gleam",
      "imports": [
        "gleam/float",
        "gleam/int",
        "gleam/io",
        "gleam/string",
        "shared/types"
      ],
      "exports": ["print_user_profile"],
      "imported_by": [],
      "status": "cli_only_unused_in_web",
      "note": "Profile printing not used in web"
    },
    "meal_planner/validation": {
      "path": "gleam/src/meal_planner/validation.gleam",
      "imports": [
        "gleam/list",
        "gleam/string",
        "meal_planner/fodmap",
        "shared/types"
      ],
      "exports": ["validate_recipes"],
      "imported_by": [],
      "status": "possibly_unused",
      "note": "Validation logic may be superseded by diet_validator"
    },
    "scripts/init_pg": {
      "path": "gleam/src/scripts/init_pg.gleam",
      "imports": [
        "envoy",
        "gleam/dynamic/decode",
        "gleam/erlang/process",
        "gleam/int",
        "gleam/io",
        "gleam/list",
        "gleam/option",
        "gleam/otp/actor",
        "gleam/result",
        "gleam/string",
        "pog",
        "simplifile"
      ],
      "exports": ["main"],
      "imported_by": [],
      "status": "script_standalone"
    },
    "scripts/restore_db": {
      "path": "gleam/src/scripts/restore_db.gleam",
      "imports": [
        "envoy",
        "gleam/io",
        "gleam/list",
        "gleam/string",
        "simplifile"
      ],
      "exports": ["main"],
      "imported_by": [],
      "status": "script_standalone"
    }
  },
  "typescript_modules": {
    ".opencode/plugin/beads-agent-mail.ts": {
      "purpose": "OpenCode plugin for task tracking and agent coordination",
      "imports": ["@opencode-ai/plugin"],
      "exports": ["BeadsAgentMailPlugin", "default"],
      "status": "active"
    },
    ".opencode/plugin/planning.ts": {
      "purpose": "OpenCode planning plugin",
      "status": "unknown"
    },
    ".opencode/plugin/quality-gates.ts": {
      "purpose": "OpenCode quality gates plugin",
      "status": "unknown"
    },
    ".opencode/plugin/session-context.ts": {
      "purpose": "OpenCode session context plugin",
      "status": "unknown"
    },
    ".opencode/plugin/tdd-workflow.ts": {
      "purpose": "OpenCode TDD workflow plugin",
      "status": "unknown"
    }
  },
  "javascript_modules": {
    "gleam/priv/static/js/recipe-form.js": {
      "purpose": "Client-side form validation and dynamic row management",
      "referenced_by": ["meal_planner/ui/recipe_form.gleam"],
      "status": "active"
    },
    ".claude/helpers/github-safe.js": {
      "purpose": "GitHub safety helper for Claude",
      "status": "helper_script"
    }
  },
  "orphaned_modules": [
    {
      "name": "meal_planner/auto_planner",
      "reason": "newly created, no imports detected",
      "severity": "low",
      "recommendation": "Integrate into web routes or keep for future use"
    },
    {
      "name": "meal_planner/auto_planner/storage",
      "reason": "database functions for auto_planner, not yet called",
      "severity": "low",
      "recommendation": "Activate when auto_planner is integrated"
    },
    {
      "name": "meal_planner/ui/recipe_form",
      "reason": "HTML form generator not integrated into web routes",
      "severity": "medium",
      "recommendation": "Add route handler in web.gleam"
    },
    {
      "name": "meal_planner/ui/pages/dashboard",
      "reason": "stub with TODO comments, not functional",
      "severity": "high",
      "recommendation": "Complete implementation or remove"
    },
    {
      "name": "meal_planner/ui/pages/food_search",
      "reason": "stub with TODO comments, not functional",
      "severity": "high",
      "recommendation": "Complete implementation or remove"
    },
    {
      "name": "meal_planner/ui/components/forms",
      "reason": "all functions are stubs returning TODO strings",
      "severity": "high",
      "recommendation": "Complete implementation or remove"
    },
    {
      "name": "meal_planner/state",
      "reason": "stateful actor not used in stateless web architecture",
      "severity": "medium",
      "recommendation": "Remove if not needed"
    },
    {
      "name": "meal_planner/output",
      "reason": "CLI-only output functions not used in web",
      "severity": "low",
      "recommendation": "Keep for CLI if needed, otherwise remove"
    },
    {
      "name": "meal_planner/weekly_plan",
      "reason": "weekly planning not integrated in web routes",
      "severity": "medium",
      "recommendation": "Integrate or remove"
    },
    {
      "name": "meal_planner/user_profile",
      "reason": "profile printing not used in web app",
      "severity": "low",
      "recommendation": "Remove or convert to web views"
    },
    {
      "name": "meal_planner/validation",
      "reason": "possibly superseded by diet_validator module",
      "severity": "low",
      "recommendation": "Verify and consolidate or remove"
    }
  ],
  "circular_dependencies_detected": [],
  "notes": [
    "Many UI components are stubs with TODO comments - significant incomplete work",
    "Several CLI-oriented modules exist but web app is the main target",
    "auto_planner module is newly created but not yet integrated",
    "No circular dependencies detected - clean module structure",
    "TypeScript plugins are for development tooling (OpenCode integration)"
  ]
}
